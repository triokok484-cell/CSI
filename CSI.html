<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>√în t·∫≠p Khoa h·ªçc M√°y t√≠nh - CSI106</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-color: #4a90e2;
            --secondary-color: #50e3c2;
            --success-color: #7ed321;
            --danger-color: #d0021b;
            --light-color: #f9f9f9;
            --dark-color: #4a4a4a;
            --background-color: #ffffff;
            --font-color: #333;
            --border-color: #e0e0e0;
            --border-radius: 8px;
            --box-shadow: 0 4px 15px rgba(0,0,0,0.08);
        }
        * {
            box-sizing: border-box;
        }
        body {
            font-family: 'Poppins', -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            line-height: 1.7;
            background: linear-gradient(to right top, #f5f7fa, #ffffff);
            color: var(--font-color);
            margin: 0;
            padding: 20px;
            display: flex;
            justify-content: center;
            min-height: 100vh;
        }
        .container {
            background-color: var(--background-color);
            padding: 30px;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
            width: 100%;
            max-width: 800px;
        }
        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 2px solid var(--border-color);
            padding-bottom: 15px;
            margin-bottom: 25px;
        }
        h1 {
            color: var(--primary-color);
            margin: 0;
            font-size: 2rem;
            font-weight: 700;
        }
        .tabs {
            display: flex;
            margin-bottom: 25px;
            border-bottom: 1px solid var(--border-color);
        }
        .tab-button {
            padding: 12px 25px;
            border: none;
            background-color: transparent;
            cursor: pointer;
            border-bottom: 3px solid transparent;
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--dark-color);
            transition: all 0.3s ease;
            margin-bottom: -1px;
        }
        .tab-button.active, .tab-button:hover {
            color: var(--primary-color);
            border-bottom-color: var(--primary-color);
        }
        .btn {
            padding: 10px 20px;
            border: none;
            background-color: var(--primary-color);
            color: white;
            cursor: pointer;
            border-radius: var(--border-radius);
            font-size: 1rem;
            font-weight: 500;
            transition: all 0.3s ease;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 10px rgba(0,0,0,0.15);
        }
        .btn-secondary { background-color: #6c757d; }
        .btn-danger { background-color: var(--danger-color); }

        .tab-content { display: none; }
        .tab-content.active { display: block; animation: fadeIn 0.5s ease; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

        #theory-summary {
            background-color: #fdfdff;
            padding: 20px;
            border-radius: var(--border-radius);
            max-height: 500px;
            overflow-y: auto;
            border: 1px solid var(--border-color);
        }
        #theory-summary p { margin: 0 0 12px 0; border-left: 4px solid var(--secondary-color); padding-left: 15px; }
        #theory-summary span { font-weight: 600; color: var(--primary-color); }

        #quiz-setup { text-align: center; padding: 30px 0; }
        #quiz-setup h3 { margin-top: 0; margin-bottom: 20px; }
        #num-questions-input {
            padding: 10px;
            font-size: 1rem;
            border: 1px solid var(--border-color);
            border-radius: var(--border-radius);
            width: 80px;
            text-align: center;
            margin-right: 10px;
        }

        #quiz-container { text-align: center; }
        #progress-bar-container {
            width: 100%;
            background-color: var(--border-color);
            border-radius: var(--border-radius);
            margin-bottom: 10px;
        }
        #progress-bar {
            width: 0%;
            height: 10px;
            background-color: var(--secondary-color);
            border-radius: var(--border-radius);
            transition: width 0.5s ease;
        }
        #question-text { font-size: 1.5rem; margin-bottom: 25px; font-weight: 500; }
        #answers-container { display: flex; flex-direction: column; gap: 12px; }
        .answer-btn {
            display: flex;
            align-items: center;
            width: 100%;
            text-align: left;
            padding: 15px;
            background-color: var(--background-color);
            border: 2px solid var(--border-color);
            border-radius: var(--border-radius);
            cursor: pointer;
            font-size: 1rem;
            transition: all 0.3s ease;
        }
        .answer-btn:hover:not(:disabled) {
            border-color: var(--primary-color);
            transform: scale(1.02);
        }
        .answer-btn:disabled { cursor: not-allowed; opacity: 0.8; }
        .answer-btn.correct, .answer-btn.incorrect { transform: scale(1); }
        .answer-btn.correct { border-color: var(--success-color); background-color: #f0fff4; }
        .answer-btn.incorrect { border-color: var(--danger-color); background-color: #fff5f5; }
        .answer-btn::after {
            font-size: 1.5rem;
            margin-left: auto;
        }
        .answer-btn.correct::after { content: '‚úîÔ∏è'; color: var(--success-color); }
        .answer-btn.incorrect::after { content: '‚ùå'; color: var(--danger-color); }
        
        #quiz-footer {
            margin-top: 25px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        #memory-tip {
            margin-top: 20px;
            padding: 15px;
            background-color: #fff3cd;
            border: 1px solid #ffeeba;
            border-radius: var(--border-radius);
            color: #856404;
            text-align: left;
        }
        
        #results-container h2 { text-align: center; }
        #score { font-size: 2.2rem; font-weight: bold; color: var(--primary-color); }
        #results-list { list-style-type: none; padding: 0; }
        #results-list li {
            padding: 15px;
            border: 1px solid var(--border-color);
            border-radius: var(--border-radius);
            margin-bottom: 15px;
        }
        .result-correct { border-left: 5px solid var(--success-color); background-color: #f7fff9; }
        .result-incorrect { border-left: 5px solid var(--danger-color); background-color: #fffafa; }
        .result-question { font-weight: 600; }
        .result-answer { margin-top: 8px; font-size: 0.95rem; }
        .result-tip { margin-top: 10px; font-size: 0.9rem; font-style: italic; color: #555; }
    </style>
</head>
<body>

<div class="container">
    <header>
        <h1>√în t·∫≠p CSI106</h1>
        <button id="lang-toggle-btn" class="btn btn-secondary">Translate to English</button>
    </header>

    <div class="tabs">
        <button id="theory-tab-btn" class="tab-button active" onclick="switchTab('theory')">L√Ω Thuy·∫øt</button>
        <button id="quiz-tab-btn" class="tab-button" onclick="switchTab('quiz')">L√†m Quiz</button>
    </div>

    <div id="theory-content" class="tab-content active">
        <h2 id="theory-title">T√≥m T·∫Øt L√Ω Thuy·∫øt C·ªët L√µi</h2>
        <div id="theory-summary"></div>
    </div>

    <div id="quiz-content" class="tab-content">
        <div id="quiz-setup">
            <h3 id="quiz-setup-title">Nh·∫≠p s·ªë c√¢u h·ªèi b·∫°n mu·ªën l√†m:</h3>
            <input type="number" id="num-questions-input" min="1" max="182" value="10">
            <button id="start-quiz-btn" class="btn" onclick="startQuiz()">B·∫Øt ƒë·∫ßu</button>
        </div>

        <div id="quiz-container" style="display: none;">
            <div id="progress-bar-container"><div id="progress-bar"></div></div>
            <p id="progress-text"></p>
            <div id="question-text"></div>
            <div id="answers-container"></div>
            <div id="memory-tip" style="display: none;"></div>
            <div id="quiz-footer">
                <button id="submit-btn" class="btn btn-danger" onclick="submitQuiz()">N·ªôp b√†i</button>
                <button id="next-btn" class="btn" onclick="nextQuestion()" style="display: none;">C√¢u Ti·∫øp Theo</button>
            </div>
        </div>

        <div id="results-container" style="display: none;">
            <h2 id="results-title">K·∫øt qu·∫£</h2>
            <p id="score" style="text-align: center;"></p>
            <ul id="results-list"></ul>
            <div style="text-align: center; margin-top: 20px;">
                <button id="restart-btn" class="btn" onclick="restartQuiz()">L√†m l·∫°i</button>
            </div>
        </div>
    </div>
</div>

<script>
// --- START OF QUESTION BANK (PASTE ALL 182 QUESTIONS HERE) ---
const mcqBank = [
    {
        "id": 1,
        "question_vi": "M·ªôt gi·∫£i ph√°p t·ª´ng b∆∞·ªõc cho m·ªôt v·∫•n ƒë·ªÅ ƒë∆∞·ª£c g·ªçi l√† _______.",
        "question_en": "A step-by-step solution to a problem is called _______.",
        "answers_vi": [{"text": "ph·∫ßn c·ª©ng", "correct": false}, {"text": "m·ªôt h·ªá ƒëi·ªÅu h√†nh", "correct": false}, {"text": "m·ªôt ng√¥n ng·ªØ m√°y t√≠nh", "correct": false}, {"text": "m·ªôt thu·∫≠t to√°n", "correct": true}],
        "answers_en": [{"text": "hardware", "correct": false}, {"text": "an operating system", "correct": false}, {"text": "a computer language", "correct": false}, {"text": "an algorithm", "correct": true}],
        "tip_vi": "Thu·∫≠t to√°n (Algorithm) l√† m·ªôt chu·ªói c√°c h∆∞·ªõng d·∫´n ho·∫∑c quy t·∫Øc ƒë∆∞·ª£c x√°c ƒë·ªãnh r√µ r√†ng ƒë·ªÉ gi·∫£i quy·∫øt m·ªôt v·∫•n ƒë·ªÅ c·ª• th·ªÉ.",
        "tip_en": "An Algorithm is a sequence of well-defined instructions or rules to solve a specific problem."
    },
    // ... PASTE THE OTHER 181 QUESTIONS HERE ...
    {
        "id": 182,
        "question_vi": "C√°i n√†o sau ƒë√¢y ƒë·∫°i di·ªán cho m·ªôt t·∫≠p h·ª£p c√°c m·ª•c d·ªØ li·ªáu chia s·∫ª m·ªôt m·ªëi quan h·ªá c·ª• th·ªÉ?",
        "question_en": "Which of the following represents a set of data items that share a specific relationship?",
        "answers_vi": [{"text": "ADT", "correct": false}, {"text": "C·∫•u tr√∫c d·ªØ li·ªáu", "correct": true}, {"text": "Ng√¥n ng·ªØ l·∫≠p tr√¨nh", "correct": false}, {"text": "Ph·∫ßn t·ª≠ d·ªØ li·ªáu", "correct": false}],
        "answers_en": [{"text": "ADT", "correct": false}, {"text": "Data structure", "correct": true}, {"text": "Programming language", "correct": false}, {"text": "Data element", "correct": false}],
        "tip_vi": "C·∫•u tr√∫c d·ªØ li·ªáu (Data Structure) l√† c√°ch t·ªï ch·ª©c, qu·∫£n l√Ω v√† l∆∞u tr·ªØ d·ªØ li·ªáu ƒë·ªÉ c√≥ th·ªÉ truy c·∫≠p v√† s·ª≠a ƒë·ªïi m·ªôt c√°ch hi·ªáu qu·∫£.",
        "tip_en": "A Data Structure is a way of organizing, managing, and storing data to enable efficient access and modification."
    }
];
// --- END OF QUESTION BANK ---

// State variables
let currentLanguage = 'vi';
let quizQuestions = [];
let currentQuestionIndex = 0;
let score = 0;
let userAnswers = [];
let totalQuestionsSelected = 0;
let theorySummaries = {};

// UI Elements
const uiElements = {
    langBtn: document.getElementById('lang-toggle-btn'),
    theoryContent: document.getElementById('theory-content'),
    quizContent: document.getElementById('quiz-content'),
    theorySummaryDiv: document.getElementById('theory-summary'),
    quizSetupDiv: document.getElementById('quiz-setup'),
    quizContainerDiv: document.getElementById('quiz-container'),
    resultsContainerDiv: document.getElementById('results-container'),
    questionTextDiv: document.getElementById('question-text'),
    answersContainerDiv: document.getElementById('answers-container'),
    progressTextP: document.getElementById('progress-text'),
    progressBar: document.getElementById('progress-bar'),
    memoryTipDiv: document.getElementById('memory-tip'),
    resultsListUl: document.getElementById('results-list'),
    scoreP: document.getElementById('score'),
    nextBtn: document.getElementById('next-btn'),
    submitBtn: document.getElementById('submit-btn'),
    numQuestionsInput: document.getElementById('num-questions-input')
};

// --- THEORY TAB LOGIC ---
function generateTheoryFromBank() {
    let summary_vi = '';
    let summary_en = '';

    mcqBank.forEach(q => {
        const correctAnswerVi = q.answers_vi.find(a => a.correct).text;
        const correctAnswerEn = q.answers_en.find(a => a.correct).text;
        
        const questionVi = q.question_vi.replace('_______', `<span>${correctAnswerVi}</span>`);
        const questionEn = q.question_en.replace('_______', `<span>${correctAnswerEn}</span>`);

        summary_vi += `<p>${questionVi}</p>`;
        summary_en += `<p>${questionEn}</p>`;
    });

    theorySummaries = { vi: summary_vi, en: summary_en };
}

function renderTheory() {
    uiElements.theorySummaryDiv.innerHTML = theorySummaries[currentLanguage];
}

// --- LANGUAGE TOGGLE LOGIC ---
function toggleLanguage() {
    currentLanguage = (currentLanguage === 'vi') ? 'en' : 'vi';
    updateAllUIText();
    if (uiElements.theoryContent.classList.contains('active')) {
        renderTheory();
    }
    if (uiElements.quizContainerDiv.style.display !== 'none') {
        renderCurrentQuestion(true); // true indicates it's a language switch
    }
    if (uiElements.resultsContainerDiv.style.display !== 'none') {
        showResults();
    }
}

function updateAllUIText() {
    const isVietnamese = currentLanguage === 'vi';
    const uiText = {
        mainTitle: { vi: '√în t·∫≠p CSI106', en: 'CSI106 Review' },
        langBtn: { vi: 'Translate to English', en: 'D·ªãch sang Ti·∫øng Vi·ªát' },
        theoryTab: { vi: 'L√Ω Thuy·∫øt', en: 'Theory' },
        quizTab: { vi: 'L√†m Quiz', en: 'Quiz' },
        theoryTitle: { vi: 'T√≥m T·∫Øt L√Ω Thuy·∫øt C·ªët L√µi', en: 'Core Theory Summary' },
        quizSetupTitle: { vi: 'Nh·∫≠p s·ªë c√¢u h·ªèi b·∫°n mu·ªën l√†m:', en: 'Enter the number of questions:' },
        startQuizBtn: { vi: 'B·∫Øt ƒë·∫ßu', en: 'Start Quiz' },
        submitBtn: { vi: 'N·ªôp b√†i', en: 'Submit' },
        nextBtn: { vi: 'C√¢u Ti·∫øp Theo', en: 'Next Question' },
        resultsTitle: { vi: 'K·∫øt qu·∫£', en: 'Results' },
        restartBtn: { vi: 'L√†m l·∫°i', en: 'Restart' }
    };

    document.querySelector('h1').textContent = uiText.mainTitle[currentLanguage];
    uiElements.langBtn.textContent = uiText.langBtn[currentLanguage];
    document.getElementById('theory-tab-btn').textContent = uiText.theoryTab[currentLanguage];
    document.getElementById('quiz-tab-btn').textContent = uiText.quizTab[currentLanguage];
    document.getElementById('theory-title').textContent = uiText.theoryTitle[currentLanguage];
    document.getElementById('quiz-setup-title').textContent = uiText.quizSetupTitle[currentLanguage];
    document.getElementById('start-quiz-btn').textContent = uiText.startQuizBtn[currentLanguage];
    uiElements.submitBtn.textContent = uiText.submitBtn[currentLanguage];
    uiElements.nextBtn.textContent = uiText.nextBtn[currentLanguage];
    document.getElementById('results-title').textContent = uiText.resultsTitle[currentLanguage];
    document.getElementById('restart-btn').textContent = uiText.restartBtn[currentLanguage];
}

// --- TAB SWITCHING LOGIC ---
function switchTab(tabName) {
    document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
    document.querySelectorAll('.tab-button').forEach(b => b.classList.remove('active'));
    document.getElementById(`${tabName}-content`).classList.add('active');
    document.getElementById(`${tabName}-tab-btn`).classList.add('active');
}

// --- QUIZ LOGIC ---
function shuffleArray(array) {
    for (let i = array.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [array[i], array[j]] = [array[j], array[i]];
    }
    return array;
}

function startQuiz() {
    const num = parseInt(uiElements.numQuestionsInput.value);
    if (isNaN(num) || num < 1 || num > mcqBank.length) {
        const alertMsg = currentLanguage === 'vi' 
            ? `Vui l√≤ng nh·∫≠p m·ªôt s·ªë h·ª£p l·ªá t·ª´ 1 ƒë·∫øn ${mcqBank.length}.`
            : `Please enter a valid number between 1 and ${mcqBank.length}.`;
        alert(alertMsg);
        return;
    }
    
    totalQuestionsSelected = num;
    score = 0;
    currentQuestionIndex = 0;
    userAnswers = new Array(totalQuestionsSelected).fill(null);
    
    let shuffledBank = shuffleArray([...mcqBank]);
    quizQuestions = shuffledBank.slice(0, totalQuestionsSelected);

    uiElements.quizSetupDiv.style.display = 'none';
    uiElements.resultsContainerDiv.style.display = 'none';
    uiElements.quizContainerDiv.style.display = 'block';

    renderCurrentQuestion(false);
}

function renderCurrentQuestion(isLanguageSwitch = false) {
    if (currentQuestionIndex >= quizQuestions.length) return;
    
    const questionData = quizQuestions[currentQuestionIndex];
    const questionLang = currentLanguage === 'vi' ? 'question_vi' : 'question_en';
    const answersLang = currentLanguage === 'vi' ? 'answers_vi' : 'answers_en';
    
    uiElements.progressBar.style.width = `${((currentQuestionIndex) / totalQuestionsSelected) * 100}%`;
    uiElements.progressTextP.textContent = `${currentLanguage === 'vi' ? 'C√¢u' : 'Question'} ${currentQuestionIndex + 1} / ${totalQuestionsSelected}`;
    uiElements.questionTextDiv.textContent = questionData[questionLang];
    uiElements.answersContainerDiv.innerHTML = '';
    uiElements.memoryTipDiv.style.display = 'none';
    uiElements.nextBtn.style.display = 'none';
    uiElements.submitBtn.style.display = 'inline-block';

    const answers = isLanguageSwitch 
        ? [...questionData[answersLang]] // Keep order for consistency on translate
        : shuffleArray([...questionData[answersLang]]);
    
    answers.forEach(answer => {
        const button = document.createElement('button');
        button.className = 'answer-btn';
        button.innerHTML = answer.text;
        button.onclick = () => selectAnswer(button, answer.correct, answer.text);
        uiElements.answersContainerDiv.appendChild(button);
    });

    // Re-apply state if language was switched
    const answered = userAnswers[currentQuestionIndex];
    if (isLanguageSwitch && answered) {
        applyAnswerState(answered);
    }
}

function selectAnswer(selectedButton, isCorrect, selectedText) {
    userAnswers[currentQuestionIndex] = { text: selectedText, isCorrect: isCorrect };
    applyAnswerState(userAnswers[currentQuestionIndex]);
    if (isCorrect) score++;
}

function applyAnswerState(answered) {
    const { text, isCorrect } = answered;
    const correctText = quizQuestions[currentQuestionIndex][currentLanguage === 'vi' ? 'answers_vi' : 'answers_en'].find(a => a.correct).text;
    
    document.querySelectorAll('.answer-btn').forEach(btn => {
        btn.disabled = true;
        if (btn.innerHTML === text) {
            btn.classList.add(isCorrect ? 'correct' : 'incorrect');
        } else if (btn.innerHTML === correctText) {
            btn.classList.add('correct');
        }
    });

    if (!isCorrect) {
        const tipLang = currentLanguage === 'vi' ? 'tip_vi' : 'tip_en';
        uiElements.memoryTipDiv.textContent = `${currentLanguage === 'vi' ? 'M·∫πo ghi nh·ªõ' : 'Memory Tip'}: ${quizQuestions[currentQuestionIndex][tipLang]}`;
        uiElements.memoryTipDiv.style.display = 'block';
    }

    uiElements.nextBtn.style.display = 'inline-block';
    uiElements.submitBtn.style.display = 'none';
}


function nextQuestion() {
    currentQuestionIndex++;
    if (currentQuestionIndex < quizQuestions.length) {
        renderCurrentQuestion(false);
    } else {
        uiElements.progressBar.style.width = '100%';
        showResults();
    }
}

function submitQuiz() {
    showResults();
}

function showResults() {
    uiElements.quizContainerDiv.style.display = 'none';
    uiElements.resultsContainerDiv.style.display = 'block';
    
    const scoreText = currentLanguage === 'vi' ? `B·∫°n ƒë√∫ng ${score} / ${totalQuestionsSelected} c√¢u!` : `You got ${score} / ${totalQuestionsSelected} correct!`;
    uiElements.scoreP.textContent = scoreText;
    
    uiElements.resultsListUl.innerHTML = '';
    quizQuestions.forEach((question, index) => {
        const li = document.createElement('li');
        const userAnswer = userAnswers[index];
        const questionLang = currentLanguage === 'vi' ? 'question_vi' : 'question_en';
        const answersLang = currentLanguage === 'vi' ? 'answers_vi' : 'answers_en';
        const tipLang = currentLanguage === 'vi' ? 'tip_vi' : 'tip_en';
        const correctAnswerText = question[answersLang].find(a => a.correct).text;

        let resultHTML = `<div class="result-question">${index + 1}. ${question[questionLang]}</div>`;
        
        if (userAnswer) {
            li.classList.add(userAnswer.isCorrect ? 'result-correct' : 'result-incorrect');
            const yourAnswerLabel = currentLanguage === 'vi' ? 'B·∫°n ch·ªçn' : 'You chose';
            resultHTML += `<div class="result-answer">${yourAnswerLabel}: ${userAnswer.text}</div>`;
            if (!userAnswer.isCorrect) {
                const correctLabel = currentLanguage === 'vi' ? 'ƒê√°p √°n ƒë√∫ng' : 'Correct answer';
                resultHTML += `<div class="result-answer">${correctLabel}: ${correctAnswerText}</div>`;
                resultHTML += `<div class="result-tip">üí° ${question[tipLang]}</div>`;
            }
        } else {
            li.classList.add('result-incorrect');
            const unansweredLabel = currentLanguage === 'vi' ? 'B·∫°n ƒë√£ b·ªè qua' : 'You skipped';
            const correctLabel = currentLanguage === 'vi' ? 'ƒê√°p √°n ƒë√∫ng' : 'Correct answer';
            resultHTML += `<div class="result-answer">${unansweredLabel}</div>`;
            resultHTML += `<div class="result-answer">${correctLabel}: ${correctAnswerText}</div>`;
            resultHTML += `<div class="result-tip">üí° ${question[tipLang]}</div>`;
        }
        
        li.innerHTML = resultHTML;
        uiElements.resultsListUl.appendChild(li);
    });
}

function restartQuiz() {
    uiElements.resultsContainerDiv.style.display = 'none';
    uiElements.quizSetupDiv.style.display = 'block';
}

// --- INITIALIZATION ---
document.addEventListener('DOMContentLoaded', () => {
    uiElements.langBtn.addEventListener('click', toggleLanguage);
    generateTheoryFromBank();
    renderTheory();
    updateAllUIText();
});

</script>
</body>
</html>
