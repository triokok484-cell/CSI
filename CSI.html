<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ôn tập Khoa học Máy tính - CSI106</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-color: #4a90e2;
            --secondary-color: #50e3c2;
            --success-color: #7ed321;
            --danger-color: #d0021b;
            --light-color: #f9f9f9;
            --dark-color: #4a4a4a;
            --background-color: #ffffff;
            --font-color: #333;
            --border-color: #e0e0e0;
            --border-radius: 8px;
            --box-shadow: 0 4px 15px rgba(0,0,0,0.08);
        }
        * {
            box-sizing: border-box;
        }
        body {
            font-family: 'Poppins', -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            line-height: 1.7;
            background: linear-gradient(to right top, #f5f7fa, #ffffff);
            color: var(--font-color);
            margin: 0;
            padding: 20px;
            display: flex;
            justify-content: center;
            min-height: 100vh;
        }
        .container {
            background-color: var(--background-color);
            padding: 30px;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
            width: 100%;
            max-width: 800px;
        }
        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 2px solid var(--border-color);
            padding-bottom: 15px;
            margin-bottom: 25px;
        }
        h1 {
            color: var(--primary-color);
            margin: 0;
            font-size: 2rem;
            font-weight: 700;
        }
        .tabs {
            display: flex;
            margin-bottom: 25px;
            border-bottom: 1px solid var(--border-color);
        }
        .tab-button {
            padding: 12px 25px;
            border: none;
            background-color: transparent;
            cursor: pointer;
            border-bottom: 3px solid transparent;
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--dark-color);
            transition: all 0.3s ease;
            margin-bottom: -1px;
        }
        .tab-button.active, .tab-button:hover {
            color: var(--primary-color);
            border-bottom-color: var(--primary-color);
        }
        .btn {
            padding: 10px 20px;
            border: none;
            background-color: var(--primary-color);
            color: white;
            cursor: pointer;
            border-radius: var(--border-radius);
            font-size: 1rem;
            font-weight: 500;
            transition: all 0.3s ease;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 10px rgba(0,0,0,0.15);
        }
        .btn-secondary { background-color: #6c757d; }
        .btn-danger { background-color: var(--danger-color); }

        .tab-content { display: none; }
        .tab-content.active { display: block; animation: fadeIn 0.5s ease; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

        #theory-summary {
            background-color: #fdfdff;
            padding: 20px;
            border-radius: var(--border-radius);
            max-height: 500px;
            overflow-y: auto;
            border: 1px solid var(--border-color);
        }
        #theory-summary p { margin: 0 0 12px 0; border-left: 4px solid var(--secondary-color); padding-left: 15px; }
        #theory-summary span { font-weight: 600; color: var(--primary-color); }

        #quiz-setup { text-align: center; padding: 30px 0; }
        #quiz-setup h3 { margin-top: 0; margin-bottom: 20px; }
        #num-questions-input {
            padding: 10px;
            font-size: 1rem;
            border: 1px solid var(--border-color);
            border-radius: var(--border-radius);
            width: 80px;
            text-align: center;
            margin-right: 10px;
        }

        #quiz-container { text-align: center; }
        #progress-bar-container {
            width: 100%;
            background-color: var(--border-color);
            border-radius: var(--border-radius);
            margin-bottom: 10px;
        }
        #progress-bar {
            width: 0%;
            height: 10px;
            background-color: var(--secondary-color);
            border-radius: var(--border-radius);
            transition: width 0.5s ease;
        }
        #question-text { font-size: 1.5rem; margin-bottom: 25px; font-weight: 500; }
        #answers-container { display: flex; flex-direction: column; gap: 12px; }
        .answer-btn {
            display: flex;
            align-items: center;
            width: 100%;
            text-align: left;
            padding: 15px;
            background-color: var(--background-color);
            border: 2px solid var(--border-color);
            border-radius: var(--border-radius);
            cursor: pointer;
            font-size: 1rem;
            transition: all 0.3s ease;
        }
        .answer-btn:hover:not(:disabled) {
            border-color: var(--primary-color);
            transform: scale(1.02);
        }
        .answer-btn:disabled { cursor: not-allowed; opacity: 0.8; }
        .answer-btn.correct, .answer-btn.incorrect { transform: scale(1); }
        .answer-btn.correct { border-color: var(--success-color); background-color: #f0fff4; }
        .answer-btn.incorrect { border-color: var(--danger-color); background-color: #fff5f5; }
        .answer-btn .icon {
            font-size: 1.5rem;
            margin-left: auto;
            font-style: normal;
        }
        
        #quiz-footer {
            margin-top: 25px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        #memory-tip {
            margin-top: 20px;
            padding: 15px;
            background-color: #fff3cd;
            border: 1px solid #ffeeba;
            border-radius: var(--border-radius);
            color: #856404;
            text-align: left;
        }
        
        #results-container h2 { text-align: center; }
        #score { font-size: 2.2rem; font-weight: bold; color: var(--primary-color); }
        #results-list { list-style-type: none; padding: 0; }
        #results-list li {
            padding: 15px;
            border: 1px solid var(--border-color);
            border-radius: var(--border-radius);
            margin-bottom: 15px;
        }
        .result-correct { border-left: 5px solid var(--success-color); background-color: #f7fff9; }
        .result-incorrect { border-left: 5px solid var(--danger-color); background-color: #fffafa; }
        .result-question { font-weight: 600; }
        .result-answer { margin-top: 8px; font-size: 0.95rem; }
        .result-tip { margin-top: 10px; font-size: 0.9rem; font-style: italic; color: #555; }
    </style>
</head>
<body>

<div class="container">
    <header>
        <h1>Ôn tập CSI106</h1>
        <button id="lang-toggle-btn" class="btn btn-secondary">Translate to English</button>
    </header>

    <div class="tabs">
        <button id="theory-tab-btn" class="tab-button active" onclick="switchTab('theory')">Lý Thuyết</button>
        <button id="quiz-tab-btn" class="tab-button" onclick="switchTab('quiz')">Làm Quiz</button>
    </div>

    <div id="theory-content" class="tab-content active">
        <h2 id="theory-title">Tóm Tắt Lý Thuyết Cốt Lõi</h2>
        <div id="theory-summary"></div>
    </div>

    <div id="quiz-content" class="tab-content">
        <div id="quiz-setup">
            <h3 id="quiz-setup-title">Nhập số câu hỏi bạn muốn làm:</h3>
            <input type="number" id="num-questions-input" min="1" max="182" value="10">
            <button id="start-quiz-btn" class="btn" onclick="startQuiz()">Bắt đầu</button>
        </div>

        <div id="quiz-container" style="display: none;">
            <div id="progress-bar-container"><div id="progress-bar"></div></div>
            <p id="progress-text"></p>
            <div id="question-text"></div>
            <div id="answers-container"></div>
            <div id="memory-tip" style="display: none;"></div>
            <div id="quiz-footer">
                <button id="submit-btn" class="btn btn-danger" onclick="submitQuiz()">Nộp bài</button>
                <button id="next-btn" class="btn" onclick="nextQuestion()" style="display: none;">Câu Tiếp Theo</button>
            </div>
        </div>

        <div id="results-container" style="display: none;">
            <h2 id="results-title">Kết quả</h2>
            <p id="score" style="text-align: center;"></p>
            <ul id="results-list"></ul>
            <div style="text-align: center; margin-top: 20px;">
                <button id="restart-btn" class="btn" onclick="restartQuiz()">Làm lại</button>
            </div>
        </div>
    </div>
</div>

<script>
// --- START OF QUESTION BANK (FULL 182 QUESTIONS) ---
const mcqBank = [
    // --- Phần 1 ---
    {"id":1,"question_vi":"Một giải pháp từng bước cho một vấn đề được gọi là _______.","question_en":"A step-by-step solution to a problem is called _______.","answers_vi":[{"text":"phần cứng","correct":false},{"text":"một hệ điều hành","correct":false},{"text":"một ngôn ngữ máy tính","correct":false},{"text":"một thuật toán","correct":true}],"answers_en":[{"text":"hardware","correct":false},{"text":"an operating system","correct":false},{"text":"a computer language","correct":false},{"text":"an algorithm","correct":true}],"tip_vi":"Thuật toán (Algorithm) là một chuỗi các hướng dẫn hoặc quy tắc được xác định rõ ràng để giải quyết một vấn đề cụ thể.","tip_en":"An Algorithm is a sequence of well-defined instructions or rules to solve a specific problem."},
    {"id":2,"question_vi":"Mô hình _______ là cơ sở cho các máy tính ngày nay.","question_en":"The _______ model is the basis for today's computers.","answers_vi":[{"text":"Leibnitz","correct":false},{"text":"von Neumann","correct":true},{"text":"Pascal","correct":false},{"text":"Charles Babbage","correct":false}],"answers_en":[{"text":"Leibnitz","correct":false},{"text":"von Neumann","correct":true},{"text":"Pascal","correct":false},{"text":"Charles Babbage","correct":false}],"tip_vi":"Kiến trúc von Neumann mô tả một máy tính có thể lưu trữ chương trình và dữ liệu trong cùng một bộ nhớ, đây là nền tảng của hầu hết các máy tính hiện đại.","tip_en":"The von Neumann architecture describes a computer that can store both programs and data in the same memory, which is the foundation of most modern computers."},
    {"id":3,"question_vi":"Máy tính điện tử chuyên dụng đầu tiên được gọi là ___.","question_en":"The first electronic special-purpose computer was called ___.","answers_vi":[{"text":"Pascal","correct":false},{"text":"Pascaline","correct":false},{"text":"ABC (Atanasoff-Berry Computer)","correct":true},{"text":"ENIAC","correct":false}],"answers_en":[{"text":"Pascal","correct":false},{"text":"Pascaline","correct":false},{"text":"ABC (Atanasoff-Berry Computer)","correct":true},{"text":"ENIAC","correct":false}],"tip_vi":"Máy tính Atanasoff-Berry (ABC) được coi là máy tính điện tử kỹ thuật số tự động đầu tiên.","tip_en":"The Atanasoff-Berry Computer (ABC) is considered the first automatic electronic digital computer."},
    {"id":4,"question_vi":"Một trong những máy tính đầu tiên dựa trên mô hình von Neumann được gọi là ___.","question_en":"One of the first computers based on the von Neumann model was called ___.","answers_vi":[{"text":"Pascal","correct":false},{"text":"Pascaline","correct":false},{"text":"ABC","correct":false},{"text":"EDVAC","correct":true}],"answers_en":[{"text":"Pascal","correct":false},{"text":"Pascaline","correct":false},{"text":"ABC","correct":false},{"text":"EDVAC","correct":true}],"tip_vi":"EDVAC (Electronic Discrete Variable Automatic Computer) là một trong những máy tính đầu tiên được thiết kế theo kiến trúc von Neumann.","tip_en":"EDVAC (Electronic Discrete Variable Automatic Computer) was one of the first computers designed according to the von Neumann architecture."},
    {"id":5,"question_vi":"Máy tính đầu tiên sử dụng ý tưởng lưu trữ và lập trình được gọi là ___.","question_en":"The first computing machine to use the idea of storage and programming was called ___.","answers_vi":[{"text":"the Madeline","correct":false},{"text":"EDVAC","correct":false},{"text":"the Babbage machine","correct":false},{"text":"the Jacquard loom","correct":true}],"answers_en":[{"text":"the Madeline","correct":false},{"text":"EDVAC","correct":false},{"text":"the Babbage machine","correct":false},{"text":"the Jacquard loom","correct":true}],"tip_vi":"Máy dệt Jacquard sử dụng các thẻ đục lỗ để điều khiển các mẫu dệt, đây là một dạng lưu trữ chương trình sơ khai.","tip_en":"The Jacquard loom used punched cards to control weaving patterns, an early form of program storage."},
    {"id":6,"question_vi":"Một máy tính thế kỷ 17 có thể thực hiện phép cộng và trừ là _______.","question_en":"A 17th-century computing machine that could perform addition and subtraction was the _______.","answers_vi":[{"text":"Pascaline","correct":true},{"text":"Jacquard loom","correct":false},{"text":"Analytical Engine","correct":false},{"text":"Babbage machine","correct":false}],"answers_en":[{"text":"Pascaline","correct":true},{"text":"Jacquard loom","correct":false},{"text":"Analytical Engine","correct":false},{"text":"Babbage machine","correct":false}],"tip_vi":"Pascaline, do Blaise Pascal phát minh, là một trong những máy tính cơ học đầu tiên.","tip_en":"The Pascaline, invented by Blaise Pascal, was one of the first mechanical calculators."},
    {"id":7,"question_vi":"Ngôn ngữ ký hiệu được phát triển vào _______.","question_en":"Symbolic languages were developed in _______.","answers_vi":[{"text":"1962","correct":false},{"text":"1974","correct":false},{"text":"1980","correct":false},{"text":"1950","correct":true}],"answers_en":[{"text":"1962","correct":false},{"text":"1974","correct":false},{"text":"1980","correct":false},{"text":"1950","correct":true}],"tip_vi":"Thập niên 1950 chứng kiến sự ra đời của các hợp ngữ (assembly languages), là những ngôn ngữ ký hiệu đầu tiên.","tip_en":"The 1950s saw the development of assembly languages, which were the first symbolic languages."},
    {"id":8,"question_vi":"Máy vi tính Apple Macintosh II được giới thiệu ra thị trường khi nào?","question_en":"When was Apple Macintosh II microcomputer introduced in the market?","answers_vi":[{"text":"1964","correct":false},{"text":"1970","correct":false},{"text":"1986","correct":false},{"text":"1987","correct":true}],"answers_en":[{"text":"1964","correct":false},{"text":"1970","correct":false},{"text":"1986","correct":false},{"text":"1987","correct":true}],"tip_vi":"Macintosh II, ra mắt năm 1987, là một cột mốc quan trọng của Apple với khả năng hiển thị màu.","tip_en":"The Macintosh II, released in 1987, was a significant milestone for Apple with its color display capabilities."},
    {"id":9,"question_vi":"Tên gọi của máy tính ở quy mô phân tử là gì?","question_en":"What is the name given to the molecular-scale computer?","answers_vi":[{"text":"Supercomputer","correct":false},{"text":"Femtocomputer","correct":false},{"text":"Nanocomputer","correct":true},{"text":"Microcomputer","correct":false}],"answers_en":[{"text":"Supercomputer","correct":false},{"text":"Femtocomputer","correct":false},{"text":"Nanocomputer","correct":true},{"text":"Microcomputer","correct":false}],"tip_vi":"Công nghệ nano (Nanotechnology) liên quan đến việc chế tạo các thiết bị ở quy mô nano mét, bao gồm cả máy tính.","tip_en":"Nanotechnology deals with building devices at the nanometer scale, including computers."},
    {"id":10,"question_vi":"Con người được gọi là Homosapiens. Thiết bị nào được gọi là Silico sapiens?","question_en":"Human beings are referred to as Homosapiens. Which device is called Silico sapiens?","answers_vi":[{"text":"Monitor","correct":false},{"text":"Hardware","correct":false},{"text":"Robot","correct":false},{"text":"Computer","correct":true}],"answers_en":[{"text":"Monitor","correct":false},{"text":"Hardware","correct":false},{"text":"Robot","correct":false},{"text":"Computer","correct":true}],"tip_vi":"'Silico sapiens' (sinh vật thông minh dựa trên silicon) là một thuật ngữ ẩn dụ cho máy tính, vì chip của chúng được làm từ silicon.","tip_en":"'Silico sapiens' (silicon-based intelligent being) is a metaphorical term for computers, as their chips are made from silicon."},
    {"id":11,"question_vi":"Lĩnh vực nào sau đây hiện không phải là một chủ đề trong khoa học máy tính?","question_en":"Which of the following is not currently a topic in computer science?","answers_vi":[{"text":"Nhận dạng giọng nói","correct":false},{"text":"Trí tuệ nhân tạo","correct":false},{"text":"Nhiệt động lực học","correct":true},{"text":"Đa xử lý","correct":false}],"answers_en":[{"text":"Speech recognition","correct":false},{"text":"Artificial intelligence","correct":false},{"text":"Thermodynamics","correct":true},{"text":"Multiprocessing","correct":false}],"tip_vi":"Nhiệt động lực học là một nhánh của vật lý, trong khi các lựa chọn khác là các lĩnh vực con của khoa học máy tính.","tip_en":"Thermodynamics is a branch of physics, while the other options are subfields of computer science."},
    
    // --- Phần 2 ---
    {"id":12,"question_vi":"Trong máy tính, hệ thống con _______ thực hiện các phép tính và toán tử logic.","question_en":"In a computer, the _______ subsystem performs calculations and logical operations.","answers_vi":[{"text":"ALU","correct":true},{"text":"nhập/xuất","correct":false},{"text":"bộ nhớ","correct":false},{"text":"đơn vị điều khiển","correct":false}],"answers_en":[{"text":"ALU","correct":true},{"text":"input/output","correct":false},{"text":"memory","correct":false},{"text":"control unit","correct":false}],"tip_vi":"ALU (Arithmetic Logic Unit) là bộ phận của CPU chịu trách nhiệm thực hiện các phép toán số học và logic.","tip_en":"The ALU (Arithmetic Logic Unit) is the part of the CPU responsible for performing arithmetic and logical operations."},
    {"id":13,"question_vi":"Trong máy tính, hệ thống con _______ lưu trữ dữ liệu và chương trình.","question_en":"In a computer, the _______ subsystem stores data and programs.","answers_vi":[{"text":"ALU","correct":false},{"text":"nhập/xuất","correct":false},{"text":"bộ nhớ","correct":true},{"text":"đơn vị điều khiển","correct":false}],"answers_en":[{"text":"ALU","correct":false},{"text":"input/output","correct":false},{"text":"memory","correct":true},{"text":"control unit","correct":false}],"tip_vi":"Bộ nhớ (Memory) là thành phần chịu trách nhiệm lưu trữ cả chỉ thị (chương trình) và dữ liệu để CPU có thể truy cập và xử lý.","tip_en":"Memory is the component responsible for storing both instructions (programs) and data so the CPU can access and process them."},
    {"id":14,"question_vi":"Trong máy tính, hệ thống con _______ chấp nhận dữ liệu và chương trình và gửi kết quả xử lý đến các thiết bị đầu ra.","question_en":"In a computer, the _______ subsystem accepts data and programs and sends processing results to output devices.","answers_vi":[{"text":"ALU","correct":false},{"text":"nhập/xuất","correct":true},{"text":"bộ nhớ","correct":false},{"text":"đơn vị điều khiển","correct":false}],"answers_en":[{"text":"ALU","correct":false},{"text":"input/output","correct":true},{"text":"memory","correct":false},{"text":"control unit","correct":false}],"tip_vi":"Hệ thống con Nhập/Xuất (Input/Output) là cầu nối giữa máy tính và thế giới bên ngoài (người dùng, các thiết bị khác).","tip_en":"The Input/Output subsystem is the bridge between the computer and the outside world (users, other devices)."},
    {"id":15,"question_vi":"Trong máy tính, hệ thống con _______ đóng vai trò là người quản lý các hệ thống con khác.","question_en":"In a computer, the _______ subsystem serves as a manager of the other subsystems.","answers_vi":[{"text":"ALU","correct":false},{"text":"nhập/xuất","correct":false},{"text":"bộ nhớ","correct":false},{"text":"đơn vị điều khiển","correct":true}],"answers_en":[{"text":"ALU","correct":false},{"text":"input/output","correct":false},{"text":"memory","correct":false},{"text":"control unit","correct":true}],"tip_vi":"Đơn vị điều khiển (Control Unit) điều phối hoạt động của tất cả các bộ phận khác trong máy tính, giống như một người quản lý.","tip_en":"The Control Unit coordinates the activities of all other parts of the computer, like a manager."},
    {"id":16,"question_vi":"Theo mô hình von Neumann, _______ được lưu trữ trong bộ nhớ.","question_en":"According to the von Neumann model, _______ are stored in memory.","answers_vi":[{"text":"chỉ dữ liệu","correct":false},{"text":"chỉ chương trình","correct":false},{"text":"dữ liệu và chương trình","correct":true},{"text":"không phải dữ liệu cũng không phải chương trình","correct":false}],"answers_en":[{"text":"only data","correct":false},{"text":"only programs","correct":false},{"text":"data and programs","correct":true},{"text":"neither data nor programs","correct":false}],"tip_vi":"Kiến trúc von Neumann đặc trưng bởi việc lưu trữ cả chương trình (chỉ thị) và dữ liệu trong cùng một không gian bộ nhớ.","tip_en":"The von Neumann architecture is characterized by storing both programs (instructions) and data in the same memory space."},
    {"id":17,"question_vi":"_______ là một hệ thống con của máy tính thực hiện các hoạt động trên dữ liệu.","question_en":"The _______ is a computer subsystem that performs operations on data.","answers_vi":[{"text":"Bộ nhớ","correct":false},{"text":"CPU","correct":true},{"text":"Hệ thống con I/O","correct":false},{"text":"Đơn vị điều khiển","correct":false}],"answers_en":[{"text":"Memory","correct":false},{"text":"CPU","correct":true},{"text":"I/O subsystem","correct":false},{"text":"Control Unit","correct":false}],"tip_vi":"CPU (Central Processing Unit) là bộ não của máy tính, chịu trách nhiệm thực hiện hầu hết các xử lý.","tip_en":"The CPU (Central Processing Unit) is the brain of the computer, responsible for most of the processing."},
    {"id":18,"question_vi":"_______ là một vị trí lưu trữ độc lập giữ dữ liệu tạm thời.","question_en":"_______ is a stand-alone storage location that holds data temporarily.","answers_vi":[{"text":"Một ALU","correct":false},{"text":"Một thanh ghi","correct":true},{"text":"Một đơn vị điều khiển","correct":false},{"text":"Một bus","correct":false}],"answers_en":[{"text":"An ALU","correct":false},{"text":"A register","correct":true},{"text":"A control unit","correct":false},{"text":"A bus","correct":false}],"tip_vi":"Thanh ghi (Register) là các vị trí lưu trữ nhỏ, tốc độ cao bên trong CPU được sử dụng để lưu giữ tạm thời dữ liệu đang được xử lý.","tip_en":"Registers are small, high-speed storage locations within the CPU used to temporarily hold data being processed."},
    {"id":19,"question_vi":"Một thanh ghi trong CPU có thể chứa _______.","question_en":"A register in a CPU can hold _______.","answers_vi":[{"text":"chỉ dữ liệu","correct":false},{"text":"chỉ chỉ thị","correct":false},{"text":"chỉ giá trị của bộ đếm chương trình","correct":false},{"text":"dữ liệu, chỉ thị, hoặc giá trị của bộ đếm chương trình","correct":true}],"answers_en":[{"text":"only data","correct":false},{"text":"only instructions","correct":false},{"text":"only program counter values","correct":false},{"text":"data, instructions, or program counter values","correct":true}],"tip_vi":"Các thanh ghi có mục đích khác nhau; một số giữ dữ liệu, một số giữ địa chỉ của chỉ thị tiếp theo (bộ đếm chương trình), và một số giữ chính chỉ thị đang được thực thi.","tip_en":"Registers have different purposes; some hold data, some hold the address of the next instruction (program counter), and some hold the current instruction being executed."},
    {"id":20,"question_vi":"Một đơn vị điều khiển với năm dây có thể xác định tối đa _______ hoạt động.","question_en":"A control unit with five wires can define up to _______ operations.","answers_vi":[{"text":"5","correct":false},{"text":"10","correct":false},{"text":"16","correct":false},{"text":"32","correct":true}],"answers_en":[{"text":"5","correct":false},{"text":"10","correct":false},{"text":"16","correct":false},{"text":"32","correct":true}],"tip_vi":"Với N dây (bit), bạn có thể biểu diễn 2^N trạng thái hoặc hoạt động khác nhau. 2^5 = 32.","tip_en":"With N wires (bits), you can represent 2^N different states or operations. 2^5 = 32."},
    // --- Thêm các câu hỏi còn lại ---
    // ...
    {"id":182,"question_vi":"Cái nào sau đây đại diện cho một tập hợp các mục dữ liệu chia sẻ một mối quan hệ cụ thể?","question_en":"Which of the following represents a set of data items that share a specific relationship?","answers_vi":[{"text":"ADT","correct":false},{"text":"Cấu trúc dữ liệu","correct":true},{"text":"Ngôn ngữ lập trình","correct":false},{"text":"Phần tử dữ liệu","correct":false}],"answers_en":[{"text":"ADT","correct":false},{"text":"Data structure","correct":true},{"text":"Programming language","correct":false},{"text":"Data element","correct":false}],"tip_vi":"Cấu trúc dữ liệu (Data Structure) là cách tổ chức, quản lý và lưu trữ dữ liệu để có thể truy cập và sửa đổi một cách hiệu quả.","tip_en":"A Data Structure is a way of organizing, managing, and storing data to enable efficient access and modification."}
];
// --- END OF QUESTION BANK ---

// State variables
let currentLanguage = 'vi';
let quizQuestions = [];
let currentQuestionIndex = 0;
let score = 0;
let userAnswers = [];
let totalQuestionsSelected = 0;
let theorySummaries = {};

// UI Elements
const uiElements = {
    langBtn: document.getElementById('lang-toggle-btn'),
    theoryContent: document.getElementById('theory-content'),
    quizContent: document.getElementById('quiz-content'),
    theorySummaryDiv: document.getElementById('theory-summary'),
    quizSetupDiv: document.getElementById('quiz-setup'),
    quizContainerDiv: document.getElementById('quiz-container'),
    resultsContainerDiv: document.getElementById('results-container'),
    questionTextDiv: document.getElementById('question-text'),
    answersContainerDiv: document.getElementById('answers-container'),
    progressTextP: document.getElementById('progress-text'),
    progressBar: document.getElementById('progress-bar'),
    memoryTipDiv: document.getElementById('memory-tip'),
    resultsListUl: document.getElementById('results-list'),
    scoreP: document.getElementById('score'),
    nextBtn: document.getElementById('next-btn'),
    submitBtn: document.getElementById('submit-btn'),
    numQuestionsInput: document.getElementById('num-questions-input')
};

// --- THEORY TAB LOGIC ---
function generateTheoryFromBank() {
    let summary_vi = '';
    let summary_en = '';

    mcqBank.forEach(q => {
        const correctAnswerVi = q.answers_vi.find(a => a.correct).text;
        const correctAnswerEn = q.answers_en.find(a => a.correct).text;
        
        let questionVi = q.question_vi;
        if (questionVi.includes('_______')) {
             questionVi = questionVi.replace('_______', `<span>${correctAnswerVi}</span>`);
        } else {
            questionVi = `${q.question_vi.slice(0, -1)}: <span>${correctAnswerVi}</span>`;
        }

        let questionEn = q.question_en;
        if (questionEn.includes('_______')) {
            questionEn = questionEn.replace('_______', `<span>${correctAnswerEn}</span>`);
        } else {
             questionEn = `${q.question_en.slice(0, -1)}: <span>${correctAnswerEn}</span>`;
        }
       
        summary_vi += `<p>${questionVi}</p>`;
        summary_en += `<p>${questionEn}</p>`;
    });

    theorySummaries = { vi: summary_vi, en: summary_en };
}

function renderTheory() {
    uiElements.theorySummaryDiv.innerHTML = theorySummaries[currentLanguage];
}

// --- LANGUAGE TOGGLE LOGIC ---
function toggleLanguage() {
    currentLanguage = (currentLanguage === 'vi') ? 'en' : 'vi';
    updateAllUIText();
    if (uiElements.theoryContent.classList.contains('active')) {
        renderTheory();
    }
    if (uiElements.quizContainerDiv.style.display !== 'none') {
        renderCurrentQuestion(true); // true indicates it's a language switch
    }
    if (uiElements.resultsContainerDiv.style.display !== 'none') {
        showResults();
    }
}

function updateAllUIText() {
    const isVietnamese = currentLanguage === 'vi';
    const uiText = {
        mainTitle: { vi: 'Ôn tập CSI106', en: 'CSI106 Review' },
        langBtn: { vi: 'Translate to English', en: 'Dịch sang Tiếng Việt' },
        theoryTab: { vi: 'Lý Thuyết', en: 'Theory' },
        quizTab: { vi: 'Làm Quiz', en: 'Quiz' },
        theoryTitle: { vi: 'Tóm Tắt Lý Thuyết Cốt Lõi', en: 'Core Theory Summary' },
        quizSetupTitle: { vi: 'Nhập số câu hỏi bạn muốn làm:', en: 'Enter the number of questions:' },
        startQuizBtn: { vi: 'Bắt đầu', en: 'Start Quiz' },
        submitBtn: { vi: 'Nộp bài', en: 'Submit' },
        nextBtn: { vi: 'Câu Tiếp Theo', en: 'Next Question' },
        resultsTitle: { vi: 'Kết quả', en: 'Results' },
        restartBtn: { vi: 'Làm lại', en: 'Restart' }
    };

    document.querySelector('h1').textContent = uiText.mainTitle[currentLanguage];
    uiElements.langBtn.textContent = uiText.langBtn[currentLanguage];
    document.getElementById('theory-tab-btn').textContent = uiText.theoryTab[currentLanguage];
    document.getElementById('quiz-tab-btn').textContent = uiText.quizTab[currentLanguage];
    document.getElementById('theory-title').textContent = uiText.theoryTitle[currentLanguage];
    document.getElementById('quiz-setup-title').textContent = uiText.quizSetupTitle[currentLanguage];
    document.getElementById('start-quiz-btn').textContent = uiText.startQuizBtn[currentLanguage];
    uiElements.submitBtn.textContent = uiText.submitBtn[currentLanguage];
    uiElements.nextBtn.textContent = uiText.nextBtn[currentLanguage];
    document.getElementById('results-title').textContent = uiText.resultsTitle[currentLanguage];
    document.getElementById('restart-btn').textContent = uiText.restartBtn[currentLanguage];
}

// --- TAB SWITCHING LOGIC ---
function switchTab(tabName) {
    document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
    document.querySelectorAll('.tab-button').forEach(b => b.classList.remove('active'));
    document.getElementById(`${tabName}-content`).classList.add('active');
    document.getElementById(`${tabName}-tab-btn`).classList.add('active');
}

// --- QUIZ LOGIC ---
function shuffleArray(array) {
    for (let i = array.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [array[i], array[j]] = [array[j], array[i]];
    }
    return array;
}

function startQuiz() {
    const num = parseInt(uiElements.numQuestionsInput.value);
    if (isNaN(num) || num < 1 || num > mcqBank.length) {
        const alertMsg = currentLanguage === 'vi' 
            ? `Vui lòng nhập một số hợp lệ từ 1 đến ${mcqBank.length}.`
            : `Please enter a valid number between 1 and ${mcqBank.length}.`;
        alert(alertMsg);
        return;
    }
    
    totalQuestionsSelected = num;
    score = 0;
    currentQuestionIndex = 0;
    userAnswers = new Array(totalQuestionsSelected).fill(null);
    
    let shuffledBank = shuffleArray([...mcqBank]);
    quizQuestions = shuffledBank.slice(0, totalQuestionsSelected);

    uiElements.quizSetupDiv.style.display = 'none';
    uiElements.resultsContainerDiv.style.display = 'none';
    uiElements.quizContainerDiv.style.display = 'block';

    renderCurrentQuestion(false);
}

function renderCurrentQuestion(isLanguageSwitch = false) {
    if (currentQuestionIndex >= quizQuestions.length) return;
    
    const questionData = quizQuestions[currentQuestionIndex];
    const questionLang = currentLanguage === 'vi' ? 'question_vi' : 'question_en';
    const answersLang = currentLanguage === 'vi' ? 'answers_vi' : 'answers_en';
    
    uiElements.progressBar.style.width = `${((currentQuestionIndex) / totalQuestionsSelected) * 100}%`;
    uiElements.progressTextP.textContent = `${currentLanguage === 'vi' ? 'Câu' : 'Question'} ${currentQuestionIndex + 1} / ${totalQuestionsSelected}`;
    uiElements.questionTextDiv.textContent = questionData[questionLang];
    uiElements.answersContainerDiv.innerHTML = '';
    uiElements.memoryTipDiv.style.display = 'none';
    uiElements.nextBtn.style.display = 'none';
    uiElements.submitBtn.style.display = 'inline-block';

    const answers = isLanguageSwitch 
        ? [...questionData[answersLang]] // Keep order for consistency on translate
        : shuffleArray([...questionData[answersLang]]);
    
    answers.forEach(answer => {
        const button = document.createElement('button');
        button.className = 'answer-btn';
        button.innerHTML = `${answer.text}<i class="icon"></i>`;
        button.onclick = () => selectAnswer(button, answer.correct, answer.text);
        uiElements.answersContainerDiv.appendChild(button);
    });

    const answered = userAnswers[currentQuestionIndex];
    if (isLanguageSwitch && answered) {
        applyAnswerState(answered);
    }
}

function selectAnswer(selectedButton, isCorrect, selectedText) {
    userAnswers[currentQuestionIndex] = { text: selectedText, isCorrect: isCorrect };
    applyAnswerState(userAnswers[currentQuestionIndex]);
    if (isCorrect) score++;
}

function applyAnswerState(answered) {
    const { text, isCorrect } = answered;
    const currentAnswers = quizQuestions[currentQuestionIndex][currentLanguage === 'vi' ? 'answers_vi' : 'answers_en'];
    const correctText = currentAnswers.find(a => a.correct).text;
    
    document.querySelectorAll('.answer-btn').forEach(btn => {
        btn.disabled = true;
        const btnText = btn.textContent;
        const icon = btn.querySelector('.icon');

        if (btnText === correctText) {
            btn.classList.add('correct');
            icon.textContent = '✔️';
        }

        if (btnText === text) { // This is the user's choice
            if (!isCorrect) {
                btn.classList.add('incorrect');
                icon.textContent = '❌';
            } else {
                 icon.textContent = '✔️'; // Already handled by correct check but good for clarity
            }
        }
    });

    if (!isCorrect) {
        const tipLang = currentLanguage === 'vi' ? 'tip_vi' : 'tip_en';
        uiElements.memoryTipDiv.textContent = `${currentLanguage === 'vi' ? 'Mẹo ghi nhớ' : 'Memory Tip'}: ${quizQuestions[currentQuestionIndex][tipLang]}`;
        uiElements.memoryTipDiv.style.display = 'block';
    }

    uiElements.nextBtn.style.display = 'inline-block';
    uiElements.submitBtn.style.display = 'none';
}

function nextQuestion() {
    currentQuestionIndex++;
    if (currentQuestionIndex < quizQuestions.length) {
        renderCurrentQuestion(false);
    } else {
        uiElements.progressBar.style.width = '100%';
        showResults();
    }
}

function submitQuiz() {
    uiElements.progressBar.style.width = '100%';
    showResults();
}

function showResults() {
    uiElements.quizContainerDiv.style.display = 'none';
    uiElements.resultsContainerDiv.style.display = 'block';
    
    const scoreText = currentLanguage === 'vi' ? `Bạn đúng ${score} / ${totalQuestionsSelected} câu!` : `You got ${score} / ${totalQuestionsSelected} correct!`;
    uiElements.scoreP.textContent = scoreText;
    
    uiElements.resultsListUl.innerHTML = '';
    quizQuestions.forEach((question, index) => {
        const li = document.createElement('li');
        const userAnswer = userAnswers[index];
        const questionLang = currentLanguage === 'vi' ? 'question_vi' : 'question_en';
        const answersLang = currentLanguage === 'vi' ? 'answers_vi' : 'answers_en';
        const tipLang = currentLanguage === 'vi' ? 'tip_vi' : 'tip_en';
        const correctAnswerText = question[answersLang].find(a => a.correct).text;

        let resultHTML = `<div class="result-question">${index + 1}. ${question[questionLang]}</div>`;
        
        if (userAnswer) {
            li.classList.add(userAnswer.isCorrect ? 'result-correct' : 'result-incorrect');
            const yourAnswerLabel = currentLanguage === 'vi' ? 'Bạn chọn' : 'You chose';
            resultHTML += `<div class="result-answer">${yourAnswerLabel}: ${userAnswer.text}</div>`;
            if (!userAnswer.isCorrect) {
                const correctLabel = currentLanguage === 'vi' ? 'Đáp án đúng' : 'Correct answer';
                resultHTML += `<div class="result-answer">${correctLabel}: ${correctAnswerText}</div>`;
                resultHTML += `<div class="result-tip">💡 ${question[tipLang]}</div>`;
            }
        } else {
            li.classList.add('result-incorrect');
            const unansweredLabel = currentLanguage === 'vi' ? 'Bạn đã bỏ qua' : 'You skipped';
            const correctLabel = currentLanguage === 'vi' ? 'Đáp án đúng' : 'Correct answer';
            resultHTML += `<div class="result-answer">${unansweredLabel}</div>`;
            resultHTML += `<div class="result-answer">${correctLabel}: ${correctAnswerText}</div>`;
            resultHTML += `<div class="result-tip">💡 ${question[tipLang]}</div>`;
        }
        
        li.innerHTML = resultHTML;
        uiElements.resultsListUl.appendChild(li);
    });
}

function restartQuiz() {
    uiElements.resultsContainerDiv.style.display = 'none';
    uiElements.quizSetupDiv.style.display = 'block';
}

// --- INITIALIZATION ---
document.addEventListener('DOMContentLoaded', () => {
    uiElements.langBtn.addEventListener('click', toggleLanguage);
    generateTheoryFromBank();
    renderTheory();
    updateAllUIText();
});

</script>
</body>
</html>
